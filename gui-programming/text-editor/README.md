# [How to Make a Text Editor using Tkinter in Python](https://www.thepythoncode.com/article/text-editor-using-tkinter-python)
##
# [[] / []]()
Идея
В этом уроке мы собираемся сделать простой текстовый редактор с модулем Tkinter, который поставляется с Python, поэтому нам не нужно ничего устанавливать. Он будет иметь следующие функции.

Откройте текстовые файлы.
Редактирование текстовых файлов.
Сохранение текстовых файлов.
Открыть с помощью (наш редактор)
Мы начинаем с импорта некоторых модулей, которые нам всем позже понадобятся. Мы импортируем все из Tkinter, поэтому у нас есть все доступные переменные, а также мы импортируем модули scrolledtext и filedialog по отдельности. Прокручиваемый текст будет текстовой областью, в которую мы пишем, а filedialog позволяет нам активировать функцию askopenfilename().

# Import
from tkinter import *
from tkinter import scrolledtext
from tkinter import filedialog
Затем мы импортируем ctypes, чтобы включить высокий DPI (точек на дюйм), чтобы наше окно выглядело более четким. Под кодом вы найдете сравнение.

import ctypes
Вот как выглядит низкий DPI:

Графический интерфейс с низким разрешением

Высокий DPI:

Графический интерфейс с высоким DPI

Мы импортируем sys, чтобы проанализировать аргументы, заданные через командную строку. Позже мы используем это, чтобы включить открытие с помощью:

import sys
Настройка переменных
Теперь мы настроили некоторые переменные для нашей маленькой программы. Первые две переменные используются для сохранения согласованности при названии нашей программы. CurrentFilePath используется при сохранении файла, поэтому мы знаем, где его сохранить. Эта строка также будет добавлена к заголовку окна, как это делают многие программы, чтобы показать, какой файл редактируется. Наконец, мы определяем, какие типы файлов можно открыть с помощью нашего редактора. Мы использовали эту переменную в диалоговых диалогах файлов:

# Setup Variables
appName = 'Simple Text Editor'
nofileOpenedString = 'New File'

currentFilePath = nofileOpenedString

# Viable File Types, when opening and saving files.
fileTypes = [("Text Files","*.txt"), ("Markdown","*.md")]
Настройка Ткинтера
Далее мы собираемся настроить окно Tkinter. Для этого мы создаем новый объект Tk. После этого мы даем окну заголовок, и мы используем переменные, которые мы определили ранее.

Поскольку у нас нет файла, открытого на данный момент, он будет говорить Простой текстовый редактор - Новый файл. Мы также сделаем так, чтобы перед именем файла была добавлена звездочка, чтобы мы знали, когда у нас есть несохраненные изменения.

Затем мы устанавливаем начальные размеры окна в пикселях с помощью метода геометрии Tkinter. И последнее, но не менее важное:

# Tkinter Setup
window = Tk()

window.title(appName + " - " + currentFilePath)

# Window Dimensions in Pixel
window.geometry('500x400')

# Set the first column to occupy 100% of the width
window.grid_columnconfigure(0, weight=1)
Функции обработчика
Теперь мы настроим две функции, которые связаны с некоторыми событиями, вызываемыми виджетами Tkinter.

Действия с файлами
Первая функция вызывается, когда мы нажимаем любую из кнопок файла, чтобы мы могли сохранять открытые и создавать новые файлы. Позже вы увидите, как мы их соединяем. Мы должны получить currentFilePath, потому что он был определен вне этой функции. Наша функция будет принимать один аргумент, а именно действие, которое определяет, что мы хотим сделать. Мы проверим этот аргумент и сделаем вещи, зависящие от этого.

Поэтому, если действие открыто, мы активируем функцию askopenfilename() через модуль filedialog. Мы поставляем его с типами файлов, которые мы определили ранее, поэтому пользователь сможет открывать только эти типы файлов.

После того, как мы выберем файл, функция вернет путь к файлу. Затем мы устанавливаем заголовок окна на наш "appName - file". После этого мы устанавливаем для нашего текущегоFilePath этот путь к файлу. Теперь мы просто открываем файл и вставляем содержимое в нашу текстовую область под названием txt после того, как мы очистим его с помощью метода delete():

# Handler Functions
def fileDropDownHandeler(action):
    global currentFilePath
    # Opening a File
    if action == "open":
        file = filedialog.askopenfilename(filetypes = fileTypes)
        window.title(appName + " - " + file)
        currentFilePath = file
        with open(file, 'r') as f:
            txt.delete(1.0,END)
            txt.insert(INSERT,f.read())
Если действие новое, мы установим путь к новому файлу. Мы также удаляем текст в текстовой области и сбрасываем заголовок окна:

    # Making a new File
    elif action == "new":
        currentFilePath = nofileOpenedString
        txt.delete(1.0,END)
        window.title(appName + " - " + currentFilePath)
И последнее, но не менее важное: мы проверим наличие save или saveAs. Теперь, если файл новый или мы нажали кнопку «Сохранить как», мы спросим пользователя, где он хочет сохранить файл. Затем мы открываем файл и сохраняем текст из текстовой области. После этого мы сбросили заголовок окна, потому что, вероятно, там была звездочка:

    # Saving a file
    elif action == "save" or action == "saveAs":
        if currentFilePath == nofileOpenedString or action=='saveAs':
            currentFilePath = filedialog.asksaveasfilename(filetypes = fileTypes)
        with open(currentFilePath, 'w') as f:
            f.write(txt.get('1.0','end'))
        window.title(appName + " - " + currentFilePath)
Изменение текста
Теперь о простой функции. Всякий раз, когда текстовая область изменяется, мы будем вызывать эту функцию, чтобы просто добавить звездочку после appName и перед currentFilePath, чтобы показать пользователю, что есть несохраненные изменения:

def textchange(event):
    window.title(appName + " - *" + currentFilePath)
Виджеты
Теперь мы собираемся настроить графические элементы.

Текстовая область
Во-первых, мы настроили текстовую область и установили ее высоту на 999, чтобы она охватывала всю высоту, мы установили ее положение с помощью метода grid(). sticky=N+S+E+W, чтобы указать виджету расти во всех направлениях, когда пользователь изменяет размер окна.

В методе bind() мы говорим, что всякий раз, когда клавиша нажимается в текстовой области, мы вызываем функцию textchange():

# Text Area
txt = scrolledtext.ScrolledText(window, height=999)
txt.grid(row=1,sticky=N+S+E+W)

# Bind event in the widget to a function
txt.bind('<KeyPress>', textchange)
Меню
Теперь давайте настроим наше выпадающее меню для взаимодействия с файлами. Сначала мы создаем новое меню, которое имеет корневое окно. Мы делаем второй, который имеет корень первого меню, и мы устанавливаем отрыв в False, чтобы пользователь не мог оторвать это меню, чтобы иметь его в виде отдельного окна.

Затем мы добавляем команды в это меню с его методом add_command(). Мы должны предоставить этой функции метку, которая представляет отображаемый текст, и команду, которая затем называется функцией, если кнопка нажата. Нам нужно создать лямбда-функцию, которая вызывает нашу функцию fileDropDownHandler(). Мы должны сделать это, чтобы мы могли снабдить нашу функцию аргументом.

Мы также можем добавить разделители с помощью метода add_seperator(). В конце концов, мы добавляем это меню в виде каскада к кнопке меню и устанавливаем это меню в качестве главного меню:

# Menu
menu = Menu(window)
# set tearoff to 0
fileDropdown = Menu(menu, tearoff=False)
# Add Commands and and their callbacks
fileDropdown.add_command(label='New', command=lambda: fileDropDownHandeler("new"))
fileDropdown.add_command(label='Open', command=lambda: fileDropDownHandeler("open"))
# Adding a seperator between button types.
fileDropdown.add_separator()
fileDropdown.add_command(label='Save', command=lambda: fileDropDownHandeler("save"))
fileDropdown.add_command(label='Save as', command=lambda: fileDropDownHandeler("saveAs"))
menu.add_cascade(label='File', menu=fileDropdown)
# Set Menu to be Main Menu
window.config(menu=menu)
Открыть с помощью
Теперь нам нужно позволить пользователю открыть файл непосредственно с помощью нашей программы с помощью этого небольшого фрагмента кода. Мы проверяем, равна ли длина системного аргумента двум, мы знаем, что второй аргумент является путем к нужному файлу. Итак, теперь мы устанавливаем currentFilePath на этот путь. После этого мы делаем по сути то же самое, что и с функцией open with handler:

# Enabling "open with" by looking if the second argument was passed.
if len(sys.argv) == 2:
    currentFilePath = sys.argv[1]
    window.title(appName + " - " + currentFilePath)
    with open(currentFilePath, 'r') as f:
        txt.delete(1.0,END)
        txt.insert(INSERT,f.read())
Главная петля
В конце концов, мы вызываем метод main loop в окне, чтобы окно отображало:

# Main Loop
window.mainloop()
Витрина
Давайте посмотрим, как работает программа в этом коротком GIF:

Витрина

Заключение
Отлично! Вы успешно создали простой текстовый редактор с использованием кода Python! Посмотрите, как вы можете добавить дополнительные функции в эту программу, такие как создание сочетаний клавиш.

Если вы хотите узнать больше об использовании Tkinter, ознакомьтесь с этим учебником, если вы хотите создать проводник с помощью Python. или этот, где вы создаете приложение калькулятора вместе со многими функциями!

Полную версию кода можно получить здесь.

Если вы хотите создать больше графических интерфейсов с помощью Python, посетите нашу страницу учебных пособий по программированию с графическим интерфейсом!