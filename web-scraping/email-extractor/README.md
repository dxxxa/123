# [How to Make an Email Extractor in Python](https://www.thepythoncode.com/article/extracting-email-addresses-from-web-pages-using-python)
To run this:
- `pip3 install -r requirements.txt`
- To extract email addresses from `"https://www.randomlists.com/email-addresses"` website and save them to the file `emails.txt`:
    ```
    python email_harvester.py https://www.randomlists.com/email-addresses emails.txt
    ```
##
# [[] / []]()
Экстрактор электронной почты или комбайн - это тип программного обеспечения, используемого для извлечения адресов электронной почты из онлайн- и автономных источников, которые генерируют большой список адресов. Несмотря на то, что эти экстракторы могут служить нескольким законным целям, таким как маркетинговые кампании, к сожалению, они в основном используются для рассылки спама и фишинговых писем.

Поскольку Интернет в настоящее время является основным источником информации в Интернете, в этом уроке вы узнаете, как создать такой инструмент на Python для извлечения адресов электронной почты с веб-страниц с помощью библиотеки requests-html.

Поскольку многие веб-сайты загружают свои данные с помощью JavaScript вместо непосредственного рендеринга HTML-кода, я выбрал библиотеку requests-html, поскольку она поддерживает веб-сайты, управляемые JavaScript.

Связанные с: Как отправлять электронные письма на Python.

Хорошо, давайте начнем; нам нужно сначала установить requests-html:

pip3 install requests-html
Приступим к кодированию:

import re
from requests_html import HTMLSession
Получите: Создайте 24 этических хакерских скрипта и инструмента с помощью Python Book

Здесь нам нужен модуль re, потому что мы будем извлекать электронные письма из HTML-контента с помощью регулярных выражений. Если вы не уверены, что такое регулярное выражение, это в основном последовательность символов, которые определяют шаблон поиска (подробности см. в этом учебнике).

Я взял наиболее часто используемое и точное регулярное выражение для адресов электронной почты из этого ответа stackoverflow:

url = "https://www.randomlists.com/email-addresses"
EMAIL_REGEX = r"""(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])"""
Я знаю, что он очень длинный, но это лучший на данный момент, который определяет, как адреса электронной почты выражаются в общем виде.

строка url - это URL-адрес, с которого мы хотим получить адреса электронной почты. Я использую веб-сайт, который генерирует случайные адреса электронной почты (который загружает их с помощью Javascript).

Давайте инициируем сеанс HTML, который является расходным сеансом для сохранения сохраняемости файлов cookie и пула подключений:

# initiate an HTTP session
session = HTMLSession()
Теперь отправляем запрос GET на URL:

# get the HTTP Response
r = session.get(url)
Если вы уверены, что веб-сайт, с которого вы захватываете адреса электронной почты, использует JavaScript для загрузки большей части данных, вам необходимо выполнить следующую строку кода:

# for JAVA-Script driven websites
r.html.render()
Связанные с: Создание 24 этических хакерских скриптов и инструментов с помощью Python Book

Это перезагрузит веб-сайт в Chromium и заменит HTML-контент обновленной версией с выполнением Javascript. Конечно, для этого потребуется некоторое время. Вот почему вам нужно выполнять это только в том случае, если веб-сайт загружает свои данные с помощью JavaScript.

Заметка: Выполнение метода render() в первый раз автоматически загрузит Chromium для вас, поэтому для этого потребуется некоторое время.

Теперь, когда у нас есть HTML-контент и регулярное выражение адреса электронной почты, давайте сделаем это:

for re_match in re.finditer(EMAIL_REGEX, r.html.raw_html.decode()):
    print(re_match.group())
Метод re.finditer() возвращает итератор для всех неперекрывающихся совпадений в строке. Для каждого совпадения итератор возвращает объект соответствия. Вот почему мы получаем доступ к соответствующей строке (адресу электронной почты) с помощью метода group().

Вот результат моего исполнения:

msherr@comcast.net
miyop@yahoo.ca
ardagna@yahoo.ca
tokuhirom@att.net
atmarks@comcast.net
isotopian@live.com
hoyer@msn.com
ozawa@yahoo.com
mchugh@outlook.com
sriha@outlook.com
monopole@sbcglobal.net
monopole@sbcglobal.net
Потрясающе, всего с несколькими строками кода, мы смогли захватить адреса электронной почты с любой веб-страницы, которую мы хотели!

Вы можете расширить этот код, чтобы создать сканер для извлечения всех URL-адресоввеб-сайтов и запустить его на каждой найденной странице, а затем сохранить их в файл. Тем не менее, некоторые веб-сайты обнаружат, что вы бот, а не человек, просматривающий веб-сайт, поэтому он заблокирует ваш IP-адрес. В этом случае вам нужно использовать прокси-сервер.

В книге «Этический взлом с Python» мы создали продвинутый почтовый паук, который делает то, что упомянуто выше, наряду с другими 23 инструментами взлома. Обязательно проверьте это здесь, если вы заинтересованы!